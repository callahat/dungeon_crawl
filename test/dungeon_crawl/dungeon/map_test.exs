defmodule DungeonCrawl.Dungeon.MapTest do
  use DungeonCrawl.DataCase

  alias DungeonCrawlWeb.PlayerLocation
  alias DungeonCrawl.Dungeon.Map

  test "on_delete deletes all associated player_locations" do
    dungeon = insert_autogenerated_dungeon()
    insert_player_location(%{dungeon_id: dungeon.id})
    assert {:ok, _dungeon} = Repo.delete(dungeon)
    refute Repo.get_by(PlayerLocation, %{dungeon_id: dungeon.id})
  end
end
