defmodule DungeonCrawl.Dungeon.MapTest do
  use DungeonCrawl.DataCase

  alias DungeonCrawl.Player.Location

  test "on_delete deletes all associated player_locations" do
    dungeon = insert_autogenerated_dungeon()
    insert_player_location(%{dungeon_id: dungeon.id})
    assert {:ok, _dungeon} = Repo.delete(dungeon)
    refute Repo.get_by(Location, %{dungeon_id: dungeon.id})
  end
end
